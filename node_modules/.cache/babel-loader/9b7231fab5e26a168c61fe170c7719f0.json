{"ast":null,"code":"import { signInAction } from \"./actions\";\nimport { push } from \"connected-react-router\";\nimport { auth, FirebaseTimestamp, db } from \"../../firebase/index\";\nexport const signIn = (email, password) => {\n  return async dispatch => {\n    // Validation\n    if (email === \"\" || password === \"\") {\n      alert(\"必須項目が未入力です\");\n      return false;\n    }\n\n    auth.signInWithEmailAndPassword(email, password).then(result => {\n      const user = result.user;\n\n      if (user) {\n        const uid = user.user;\n        db.collection(\"users\").doc(uid).get().then(snapshot => {\n          const data = snapshot.data();\n          dispatch(signInAction({\n            isSignedIn: true,\n            role: data.role,\n            uid: uid,\n            username: data.username\n          }));\n          dispatch(push(\"/\"));\n        });\n      }\n    });\n  };\n};\nexport const signUp = (username, email, password, confirmPassword) => {\n  return async dispatch => {\n    // Validation\n    if (username === \"\" || email === \"\" || password === \"\" || confirmPassword === \"\") {\n      alert(\"必須項目が未入力です\");\n      return false;\n    }\n\n    if (password !== confirmPassword) {\n      alert(\"パスワードが一致しません。もう一度お試しください。\");\n      return false;\n    } // createUserWithEmailAndPasswordはfirebaseのアカウントを作るメソッド\n\n\n    return auth.createUserWithEmailAndPassword(email, password).then(result => {\n      const user = result.user;\n\n      if (user) {\n        const uid = user.uid;\n        const timestamp = FirebaseTimestamp.now();\n        const userInitialdata = {\n          created_at: timestamp,\n          email: email,\n          role: \"customer\",\n          uid: uid,\n          updatad_at: timestamp,\n          username: username\n        }; // createUserWithEmailAndPasswordで作られたアカウント情報を登録する（データベースに登録）\n\n        db.collection(\"users\").doc(uid).set(userInitialdata).then(() => {\n          // 登録が完了したらホームへ行く処理\n          dispatch(push(\"/\"));\n        });\n      }\n    });\n  };\n};","map":{"version":3,"sources":["/Users/abeshoujirou/Desktop/ec-app-trahack/src/reducks/users/operations.js"],"names":["signInAction","push","auth","FirebaseTimestamp","db","signIn","email","password","dispatch","alert","signInWithEmailAndPassword","then","result","user","uid","collection","doc","get","snapshot","data","isSignedIn","role","username","signUp","confirmPassword","createUserWithEmailAndPassword","timestamp","now","userInitialdata","created_at","updatad_at","set"],"mappings":"AAAA,SAAQA,YAAR,QAA2B,WAA3B;AACA,SAAQC,IAAR,QAAmB,wBAAnB;AACA,SAAQC,IAAR,EAAcC,iBAAd,EAAiCC,EAAjC,QAA0C,sBAA1C;AAEA,OAAO,MAAMC,MAAM,GAAG,CAACC,KAAD,EAAQC,QAAR,KAAqB;AACzC,SAAO,MAAOC,QAAP,IAAoB;AACzB;AACA,QAAIF,KAAK,KAAK,EAAV,IAAgBC,QAAQ,KAAK,EAAjC,EAAoC;AAClCE,MAAAA,KAAK,CAAC,YAAD,CAAL;AACA,aAAO,KAAP;AACD;;AAEDP,IAAAA,IAAI,CAACQ,0BAAL,CAAgCJ,KAAhC,EAAuCC,QAAvC,EACGI,IADH,CACQC,MAAM,IAAI;AACd,YAAMC,IAAI,GAAGD,MAAM,CAACC,IAApB;;AAEA,UAAGA,IAAH,EAAQ;AACN,cAAMC,GAAG,GAAGD,IAAI,CAACA,IAAjB;AAEAT,QAAAA,EAAE,CAACW,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2BF,GAA3B,EAAgCG,GAAhC,GACGN,IADH,CACQO,QAAQ,IAAI;AAChB,gBAAMC,IAAI,GAAGD,QAAQ,CAACC,IAAT,EAAb;AAEAX,UAAAA,QAAQ,CAACR,YAAY,CAAC;AACpBoB,YAAAA,UAAU,EAAE,IADQ;AAEpBC,YAAAA,IAAI,EAAEF,IAAI,CAACE,IAFS;AAGpBP,YAAAA,GAAG,EAAEA,GAHe;AAIpBQ,YAAAA,QAAQ,EAAEH,IAAI,CAACG;AAJK,WAAD,CAAb,CAAR;AAMAd,UAAAA,QAAQ,CAACP,IAAI,CAAC,GAAD,CAAL,CAAR;AACD,SAXH;AAYD;AACF,KApBH;AAqBD,GA5BD;AA6BD,CA9BM;AAgCP,OAAO,MAAMsB,MAAM,GAAG,CAACD,QAAD,EAAWhB,KAAX,EAAkBC,QAAlB,EAA4BiB,eAA5B,KAAgD;AACpE,SAAO,MAAOhB,QAAP,IAAoB;AACzB;AACA,QAAIc,QAAQ,KAAK,EAAb,IAAmBhB,KAAK,KAAK,EAA7B,IAAmCC,QAAQ,KAAK,EAAhD,IAAsDiB,eAAe,KAAK,EAA9E,EAAiF;AAC/Ef,MAAAA,KAAK,CAAC,YAAD,CAAL;AACA,aAAO,KAAP;AACD;;AAED,QAAIF,QAAQ,KAAKiB,eAAjB,EAAkC;AAChCf,MAAAA,KAAK,CAAC,2BAAD,CAAL;AACA,aAAO,KAAP;AACD,KAVwB,CAYzB;;;AACA,WAAOP,IAAI,CAACuB,8BAAL,CAAoCnB,KAApC,EAA2CC,QAA3C,EACNI,IADM,CACDC,MAAM,IAAI;AACd,YAAMC,IAAI,GAAGD,MAAM,CAACC,IAApB;;AAEA,UAAGA,IAAH,EAAQ;AACN,cAAMC,GAAG,GAAGD,IAAI,CAACC,GAAjB;AACA,cAAMY,SAAS,GAAGvB,iBAAiB,CAACwB,GAAlB,EAAlB;AAEA,cAAMC,eAAe,GAAG;AACtBC,UAAAA,UAAU,EAAEH,SADU;AAEtBpB,UAAAA,KAAK,EAAEA,KAFe;AAGtBe,UAAAA,IAAI,EAAE,UAHgB;AAItBP,UAAAA,GAAG,EAAEA,GAJiB;AAKtBgB,UAAAA,UAAU,EAAEJ,SALU;AAMtBJ,UAAAA,QAAQ,EAAEA;AANY,SAAxB,CAJM,CAYN;;AACAlB,QAAAA,EAAE,CAACW,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2BF,GAA3B,EAAgCiB,GAAhC,CAAoCH,eAApC,EACGjB,IADH,CACQ,MAAM;AACV;AACAH,UAAAA,QAAQ,CAACP,IAAI,CAAC,GAAD,CAAL,CAAR;AACD,SAJH;AAKD;AACF,KAvBM,CAAP;AAwBD,GArCD;AAsCD,CAvCM","sourcesContent":["import {signInAction} from \"./actions\";\nimport {push} from \"connected-react-router\"\nimport {auth, FirebaseTimestamp, db} from \"../../firebase/index\"\n\nexport const signIn = (email, password) => {\n  return async (dispatch) => {\n    // Validation\n    if (email === \"\" || password === \"\"){\n      alert(\"必須項目が未入力です\")\n      return false\n    }\n\n    auth.signInWithEmailAndPassword(email, password)\n      .then(result => {\n        const user = result.user\n\n        if(user){\n          const uid = user.user\n\n          db.collection(\"users\").doc(uid).get()\n            .then(snapshot => {\n              const data = snapshot.data()\n\n              dispatch(signInAction({\n                isSignedIn: true,\n                role: data.role,\n                uid: uid,\n                username: data.username\n              }))\n              dispatch(push(\"/\"))\n            })\n        }\n      })\n  }\n}\n\nexport const signUp = (username, email, password, confirmPassword) => {\n  return async (dispatch) => {\n    // Validation\n    if (username === \"\" || email === \"\" || password === \"\" || confirmPassword === \"\"){\n      alert(\"必須項目が未入力です\")\n      return false\n    }\n\n    if (password !== confirmPassword) {\n      alert(\"パスワードが一致しません。もう一度お試しください。\")\n      return false\n    }\n\n    // createUserWithEmailAndPasswordはfirebaseのアカウントを作るメソッド\n    return auth.createUserWithEmailAndPassword(email, password)\n    .then(result => {\n      const user = result.user\n\n      if(user){\n        const uid = user.uid\n        const timestamp = FirebaseTimestamp.now()\n\n        const userInitialdata = {\n          created_at: timestamp,\n          email: email,\n          role: \"customer\",\n          uid: uid,\n          updatad_at: timestamp,\n          username: username\n        }\n        // createUserWithEmailAndPasswordで作られたアカウント情報を登録する（データベースに登録）\n        db.collection(\"users\").doc(uid).set(userInitialdata)\n          .then(() => {\n            // 登録が完了したらホームへ行く処理\n            dispatch(push(\"/\"))\n          })\n      }\n    })\n  }\n}\n"]},"metadata":{},"sourceType":"module"}